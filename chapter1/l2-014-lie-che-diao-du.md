## L2-014. 列车调度 {#l2-014-列车调度}

[L2-014. 列车调度](https://www.patest.cn/contests/gplt/L2-014)  
火车站的列车调度铁轨的结构如下图所示。

![](http://nos.patest.cn/lp_o9wf01q8p76.jpg)

两端分别是一条入口（Entrance）轨道和一条出口（Exit）轨道，它们之间有N条平行的轨道。每趟列车从入口可以选择任意一条轨道进入，最后从出口离开。在图中有9趟列车，在入口处按照{8，4，2，5，3，9，1，6，7}的顺序排队等待进入。如果要求它们必须按序号递减的顺序从出口离开，则至少需要多少条平行铁轨用于调度？

输入格式：  
输入第一行给出一个整数N \(2 &lt;= N &lt;= 105\)，下一行给出从1到N的整数序号的一个重排列。数字间以空格分隔。  
输出格式：  
在一行中输出可以将输入的列车按序号递减的顺序调离所需要的最少的铁轨条数。  
输入样例：  
9  
8 4 2 5 3 9 1 6 7  
输出样例：  
4

---

### 题解: {#题解}

题意：一列无序列车，通过铁轨进行调度后，按从大到小顺序离开，求需要几条铁轨进行调度。该题意可理解为计算最少递减子序列的数目，记录时，无需将整个递减子序列的元素全出存储，只需记录其中的最小元素。  
分析：对每一列进入铁轨的列车，如果车号大于所有队列队伍的车号，则该列车不能进入已有的队列（通俗的说，就是当一个数，大于所有递减序列最末尾的数时，则这个数无法插入任何一列递减序列中，需重新组建一列递减序列。）否则，选择一个最接近它车号的队尾进入。  
  因只需记录每个递减序列的末尾数，所以只需使用一个数组或一个set集合来记录。set集合每次都会排序比较大小，则queue.rbegin\(\)是当前所有队列队尾的最大值。因最先插入0，所以最后的答案为queue.size\(\) - 1。

用样例来举例：  
8 4 2 5 3 9 1 6 7  
依次插入的结果为：  
0 8  
0 4  
0 2  
0 2 5  
0 2 3  
0 2 3 9  
0 1 3 9  
0 1 3 6  
0 1 3 6 7

---

**AC代码：**

```cpp
#include<iostream>
#include<set>

using namespace std;

set<int> queue;

int main() {

    queue.insert(0);
    int n;
    cin >> n;

    while(n--) {
        int temp = 0;
        cin >> temp;
        if(temp < *queue.rbegin()) {
            //queue.upper_bound()返回的是第一个大于t的迭代器的位置
            //queue.erase()删除
            queue.erase(*(queue.upper_bound(temp)));
        }
        queue.insert(temp);
    }
    cout << queue.size() - 1 << endl;
}
```



